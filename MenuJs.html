<script>

    $(() => google.script.run.withSuccessHandler(setSheetSelector).getSheets());
    
    function setSheetSelector(sheets) {
        for(let sheet of sheets) {
            $('#sheetSelector').append($('<option></option>').attr('value', sheet).text(sheet)); 
        }

        selectedValueChanged();
    }

    function selectedValueChanged() {
        let sheetName = $('#sheetSelector').val();
        google.script.run.withSuccessHandler(ctaTitles => {
            let dropDowns = $('select', 'div#ctaTitles');
            dropDowns.find('option').remove().end();

            for(let title of ctaTitles) {
                dropDowns.append($('<option></option>').attr('value', title).text(title));
            }
        }).selectedValueChangedHandler(sheetName);
    }

</script>